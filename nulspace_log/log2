Compared to "log1", added squared L2 consistency loss
-------

(hl) techt@techt-ROG-Strix-GA35DX-G35DX:~/Desktop/nullspace$ python train_single.py
cuda:0
vit_base_patch32_224 is pretrained? True
{'input_size': (3, 224, 224), 'interpolation': 'bicubic', 'mean': (0.5, 0.5, 0.5), 'std': (0.5, 0.5, 0.5), 'crop_pct': 0.9}
vit_base_patch32_224, 224x224, patch_size:32
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0390, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 13.711941719055176
Noise trained for 20 epochs, error: 9.519455909729004
Noise trained for 30 epochs, error: 8.68592643737793
Noise norm: 93.54717254638672
Epoch: 0, Step: 0, Loss: 13.587906837463379, consistency_ratio: 2.9727502962872285
Epoch: 0, Loss: 5.876303395917339, Acc1: 9.35%, Acc5: 15.92%
New Best Acc: 9.35%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0471, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 1.1740010976791382
Noise trained for 20 epochs, error: 0.8185534477233887
Noise trained for 30 epochs, error: 0.7712633609771729
Noise norm: 75.2662124633789
Epoch: 1, Step: 0, Loss: 6.009639263153076, consistency_ratio: 0.0496743536578829
Epoch: 1, Loss: 5.01006587859123, Acc1: 26.55%, Acc5: 68.28%
New Best Acc: 26.55%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0425, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.630702793598175
Noise trained for 20 epochs, error: 0.4574447274208069
Noise trained for 30 epochs, error: 0.436816930770874
Noise norm: 82.6416015625
Epoch: 2, Step: 0, Loss: 4.91144323348999, consistency_ratio: 0.019826413127544507
Epoch: 2, Loss: 3.624974896830897, Acc1: 46.88%, Acc5: 79.13%
New Best Acc: 46.88%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0419, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.43826037645339966
Noise trained for 20 epochs, error: 0.31704258918762207
Noise trained for 30 epochs, error: 0.28265616297721863
Noise norm: 80.76297760009766
Epoch: 3, Step: 0, Loss: 3.4920456409454346, consistency_ratio: 0.011693870709141067
Epoch: 3, Loss: 1.9910557654596144, Acc1: 49.25%, Acc5: 81.63%
New Best Acc: 49.25%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0310, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.4441799223423004
Noise trained for 20 epochs, error: 0.29891422390937805
Noise trained for 30 epochs, error: 0.2900664508342743
Noise norm: 81.09632873535156
Epoch: 4, Step: 0, Loss: 1.7723338603973389, consistency_ratio: 0.024084037546923988
Epoch: 4, Loss: 1.1735783238564768, Acc1: 72.64%, Acc5: 91.21%
New Best Acc: 72.64%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0444, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5039151906967163
Noise trained for 20 epochs, error: 0.37859782576560974
Noise trained for 30 epochs, error: 0.33503222465515137
Noise norm: 84.19219207763672
Epoch: 5, Step: 0, Loss: 1.1298854351043701, consistency_ratio: 0.05362570971436141
Epoch: 5, Loss: 0.7489942119967553, Acc1: 81.35%, Acc5: 96.87%
New Best Acc: 81.35%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0338, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5670127272605896
Noise trained for 20 epochs, error: 0.39095014333724976
Noise trained for 30 epochs, error: 0.35827764868736267
Noise norm: 84.34870147705078
Epoch: 6, Step: 0, Loss: 0.6666513085365295, consistency_ratio: 0.10151770072645167
Epoch: 6, Loss: 0.6040727553829071, Acc1: 85.27%, Acc5: 96.76%
New Best Acc: 85.27%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0378, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5871842503547668
Noise trained for 20 epochs, error: 0.4017010033130646
Noise trained for 30 epochs, error: 0.3860406279563904
Noise norm: 84.61932373046875
Epoch: 7, Step: 0, Loss: 0.6054630875587463, consistency_ratio: 0.12313742494520843
Epoch: 7, Loss: 0.5334813517908896, Acc1: 85.83%, Acc5: 96.84%
New Best Acc: 85.83%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0309, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.6144173741340637
Noise trained for 20 epochs, error: 0.41191238164901733
Noise trained for 30 epochs, error: 0.37990063428878784
Noise norm: 84.35319519042969
Epoch: 8, Step: 0, Loss: 0.4066716730594635, consistency_ratio: 0.1954394015476725
Epoch: 8, Loss: 0.43925792940201297, Acc1: 87.67%, Acc5: 97.81%
New Best Acc: 87.67%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0199, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.617562472820282
Noise trained for 20 epochs, error: 0.40842390060424805
Noise trained for 30 epochs, error: 0.37992063164711
Noise norm: 83.37774658203125
Epoch: 9, Step: 0, Loss: 0.2987124025821686, consistency_ratio: 0.2512228823636214
Epoch: 9, Loss: 0.4075638248074439, Acc1: 88.00%, Acc5: 98.04%
New Best Acc: 88.00%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0469, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.6057842373847961
Noise trained for 20 epochs, error: 0.41003555059432983
Noise trained for 30 epochs, error: 0.38714733719825745
Noise norm: 83.4915771484375
Epoch: 10, Step: 0, Loss: 0.308768093585968, consistency_ratio: 0.25033315286195795
Epoch: 10, Loss: 0.38410008338189894, Acc1: 88.56%, Acc5: 98.22%
New Best Acc: 88.56%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0421, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.6117740869522095
Noise trained for 20 epochs, error: 0.4121543765068054
Noise trained for 30 epochs, error: 0.3804229199886322
Noise norm: 82.55722045898438
Epoch: 11, Step: 0, Loss: 0.23554250597953796, consistency_ratio: 0.32361161971810976
Epoch: 11, Loss: 0.36782286244053997, Acc1: 89.22%, Acc5: 98.22%
New Best Acc: 89.22%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0403, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5997481346130371
Noise trained for 20 epochs, error: 0.4156573414802551
Noise trained for 30 epochs, error: 0.39686521887779236
Noise norm: 83.06786346435547
Epoch: 12, Step: 0, Loss: 0.19473768770694733, consistency_ratio: 0.4074092959282274
Epoch: 12, Loss: 0.36218074060255484, Acc1: 89.40%, Acc5: 98.22%
New Best Acc: 89.40%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0533, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.580700695514679
Noise trained for 20 epochs, error: 0.40696433186531067
Noise trained for 30 epochs, error: 0.3637167811393738
Noise norm: 82.45821380615234
Epoch: 13, Step: 0, Loss: 0.14269238710403442, consistency_ratio: 0.5235465749212428
Epoch: 13, Loss: 0.34846539651193925, Acc1: 90.01%, Acc5: 98.19%
New Best Acc: 90.01%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0451, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5876930952072144
Noise trained for 20 epochs, error: 0.40513989329338074
Noise trained for 30 epochs, error: 0.3804829716682434
Noise norm: 82.74290466308594
Epoch: 14, Step: 0, Loss: 0.13993076980113983, consistency_ratio: 0.5304713446552191
Epoch: 14, Loss: 0.34503527610532697, Acc1: 90.27%, Acc5: 98.27%
New Best Acc: 90.27%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0258, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5960792303085327
Noise trained for 20 epochs, error: 0.4000646770000458
Noise trained for 30 epochs, error: 0.3709034025669098
Noise norm: 81.77770233154297
Epoch: 15, Step: 0, Loss: 0.14861619472503662, consistency_ratio: 0.5052157112482223
Epoch: 15, Loss: 0.3405281189949282, Acc1: 90.27%, Acc5: 98.27%
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0438, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5646466016769409
Noise trained for 20 epochs, error: 0.37858250737190247
Noise trained for 30 epochs, error: 0.35596421360969543
Noise norm: 82.41460418701172
Epoch: 16, Step: 0, Loss: 0.17086462676525116, consistency_ratio: 0.4004364841672397
Epoch: 16, Loss: 0.3384235135970577, Acc1: 90.45%, Acc5: 98.27%
New Best Acc: 90.45%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0394, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5762875080108643
Noise trained for 20 epochs, error: 0.3913954794406891
Noise trained for 30 epochs, error: 0.359950453042984
Noise norm: 81.987548828125
Epoch: 17, Step: 0, Loss: 0.08310091495513916, consistency_ratio: 0.8159405908953412
Epoch: 17, Loss: 0.3355735655753843, Acc1: 90.45%, Acc5: 98.32%
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0221, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.573255717754364
Noise trained for 20 epochs, error: 0.3791317939758301
Noise trained for 30 epochs, error: 0.35512417554855347
Noise norm: 81.49456787109375
Epoch: 18, Step: 0, Loss: 0.11883025616407394, consistency_ratio: 0.5524538053947415
Epoch: 18, Loss: 0.3289166419736801, Acc1: 90.52%, Acc5: 98.37%
New Best Acc: 90.52%!
torch.Size([1, 49, 768])
Starting magnitude torch.Size([1, 49, 768]) tensor(4.0362, device='cuda:0', grad_fn=<MeanBackward0>)
Noise trained for 10 epochs, error: 0.5495620965957642
Noise trained for 20 epochs, error: 0.3864021897315979
Noise trained for 30 epochs, error: 0.366239994764328
Noise norm: 81.82013702392578
Epoch: 19, Step: 0, Loss: 0.12195852398872375, consistency_ratio: 0.5686872687967022
Epoch: 19, Loss: 0.32714812986312375, Acc1: 90.65%, Acc5: 98.39%
New Best Acc: 90.65%!

